(()=>{"use strict";const t=function(){const a=Object.keys(localStorage).reverse(),n=document.querySelector(".project-items");let s=document.querySelector(".selected");s=null===s||"Home"===s.id?"":s.textContent,n.innerHTML="",a.forEach((e=>{if("Home"===e)return;let a=m({tag:"div",classList:["project-item"]}),i=m({tag:"i",classList:["fa","fa-times","sm","remove-p-item"]}),r=m({tag:"div",classList:["project-name"],text:e});s===e&&r.classList.add("selected"),i.addEventListener("click",(a=>{localStorage.removeItem(e);let n=document.querySelector(".selected");n=n.textContent,n===e&&(document.querySelector(".main-container").innerHTML=""),t()})),a.append(r,i),n.appendChild(a)})),e()},e=function(){const t=document.querySelector("#projects"),e=document.querySelectorAll(".project-name"),s=document.querySelector("#home");s.addEventListener("click",a.bind(null,s)),e.forEach((t=>{t.addEventListener("click",a.bind(null,t))})),t.addEventListener("click",(t=>{document.querySelector(".overlay")||(container.appendChild(d()),n())}))},a=function(t,e){let a=document.querySelector(".selected");t!==a&&(null!=a&&a.classList.remove("selected"),t.classList.add("selected"),"home"===t.id?i("Home"):i(t.textContent))},n=function(){document.querySelector(".submit-btn").addEventListener("click",s)};function s(e){let a=document.querySelector(".p-form-text").value;a=a.charAt(0).toUpperCase()+a.slice(1),""!==a?a.length>12?alert("Value too big"):(document.querySelector(".overlay").remove(),null===localStorage.getItem(a)?(localStorage.setItem(a,JSON.stringify([])),t()):alert("Project already exists.")):alert("Please enter a value")}const i=function(t){const e=document.querySelector(".main-container");let a=JSON.parse(localStorage.getItem(t));if(null===a)return void alert("Page does not exist.");e.innerHTML="";let n=m({tag:"div",classList:["header"]}),s=m({tag:"div",classList:["main-heading"],text:t}),i=m({tag:"button",text:"New Task",classList:["new-task-btn"]});i.addEventListener("click",c),n.append(s,i),e.appendChild(n),r(a,e),o(t,a)},r=function(t,e){e.appendChild(p(t)),l()},o=function(t,e){document.querySelectorAll(".remove-task").forEach((a=>{a.addEventListener("click",(n=>{e.splice(parseInt(a.parentElement.id),1),localStorage.setItem(t,JSON.stringify(e)),i(t)}))}))},l=function(){var t,e=document.getElementsByClassName("task");for(t=0;t<e.length;t++)e[t].addEventListener("click",(function(){this.classList.toggle("active");var t=this.nextElementSibling;"block"===t.style.display?t.style.display="none":t.style.display="block"}))},c=function(){container.appendChild(u("Create")),document.querySelector(".t-content").addEventListener("submit",(t=>{t.preventDefault(),document.querySelector(".overlay").remove();let e=document.querySelector(".selected");e="Home"===e.id?"Home":e.textContent;const a=localStorage.getItem(e),n=Object.fromEntries(new FormData(t.target).entries());if(null===a)return void alert("Project does not exist.");let s=JSON.parse(a);s.push(n),localStorage.setItem(e,JSON.stringify(s)),i(e)}))},d=function(){const t=m({tag:"div",classList:["p-form-buttons"]}),e=m({tag:"button",text:"Cancel",classList:["cancel-btn"]});e.addEventListener("click",(t=>{document.querySelector(".overlay").remove()})),t.append(e,m({tag:"button",text:"Okay",classList:["submit-btn"]}));const a=m({tag:"div",classList:["project-form"]});a.append(m({tag:"div",text:"Create New Project",classList:["p-form-heading"]}),m({tag:"input",attr:{type:"text",placeholder:"Project Name"},classList:["p-form-text"]}),t);let n=m({tag:"div",classList:["overlay"]});return n.append(a),n},u=function(t){const e=m({tag:"div",classList:["t-form-buttons"]}),a=m({tag:"button",text:"Cancel",classList:["cancel-btn","b"]});a.addEventListener("click",(t=>{document.querySelector(".overlay").remove()})),e.append(a,m({tag:"button",text:t,attr:{for:"task-form"},classList:["t-submit-btn","b"]}));const n=m({tag:"div",classList:["task-form"]}),s=m({tag:"label",text:"Title:"});s.append(m({tag:"input",attr:{type:"text",required:"",name:"title"},classList:["t-title"]}));const i=m({tag:"label",text:"Description:"});i.append(m({tag:"textarea",attr:{rows:"4",name:"description"},classList:["t-description"]}));const r=m({tag:"label",classList:["m"]});r.innerHTML='Priority:\n   <input id="low" type="radio" name="priority" value="low" checked>\n   <label class="r" for="low">Low</label>\n   <input id="medium" type="radio" name="priority" value="medium">\n   <label class="r" for="medium">Medium</label>\n   <input id="high" type="radio" name="priority" value="high">\n   <label class="r" for="high">High</label>';const o=m({tag:"label",text:"Due Date:",classList:["m"]});o.append(m({tag:"input",attr:{type:"date",required:"",name:"dueDate"}}));const l=m({tag:"form",classList:["t-content"],attr:{id:"task-form",action:" ",method:"post"}});l.append(s,i,r,o,e),n.append(m({tag:"div",text:`${t} task`,classList:["t-form-heading"]}),l);let c=m({tag:"div",classList:["overlay"]});return c.append(n),c},m=function(t){let e=document.createElement(t.tag);if("attr"in t){let a=t.attr;for(let[t,n]of Object.entries(a))e.setAttribute(t,n)}return null!=t.classList&&e.classList.add(...t.classList),"text"in t&&(e.textContent=t.text),e},p=function(t){let e=m({tag:"div",class:"tasks-container"}),a=-1;return t.forEach((t=>{let n=t.priority,s="";a+=1,s="low"===n?"task-blue":"medium"===n?"task-yellow":"task-red";const r=m({tag:"div",classList:[s,"task"]});r.append(m({tag:"div",classList:["task-title"],text:t.title}),m({tag:"div",classList:["task-due-date"],text:t.dueDate}),m({tag:"i",classList:["fa","fa-times","sm","remove-task"]}));const o=m({tag:"div",classList:["hidden"]}),l=m({tag:"div",classList:["task-description"]});l.innerHTML=`<span class="bold">Details:</span> ${t.description}`;const c=m({tag:"div",classList:["task-priority"]});c.innerHTML=`<span class="bold">Priority:</span> ${t.priority}`;const d=m({tag:"button",classList:["edit-task"],text:"Edit Details"});d.addEventListener("click",(e=>{!function(t,e){document.querySelector(".overlay")||(document.querySelector("#container").appendChild(u("Edit")),document.querySelector(".t-title").value=t.title,document.querySelector(".t-description").value=t.description,document.querySelector(`#${t.priority}`).checked=!0,document.querySelector("[name = dueDate]").value=t.dueDate,document.querySelector(".task-form").addEventListener("submit",(a=>{a.preventDefault();let n=document.querySelector(".selected");n="Home"===n.id?"Home":n.textContent;const s=localStorage.getItem(n),r=Object.fromEntries(new FormData(a.target).entries());if(null===s)return void alert("Project does not exist.");if(JSON.stringify(r)===JSON.stringify(t))return void alert("No changes made");document.querySelector(".overlay").remove();let o=JSON.parse(s);o.splice(e,1,r),localStorage.setItem(n,JSON.stringify(o)),i(n)})))}(t,a)})),o.append(l,c,d),e.append(r,o)})),e},g=function(){let t=m({tag:"div",classList:["nav-bar"]});return t.append(m({tag:"i",classList:["fa","fa-tasks","fa-3x"],attr:{"aria-hidden":"true"}}),m({tag:"div",classList:["nav-heading"],text:"To-Do"}),m({tag:"div",classList:["nav-side"],text:"Tasks and Notes"})),t},v=function(){let t=m({tag:"div",classList:["side-bar"]});return t.append(f("home","Home"),f("briefcase","Projects")),t},f=function(t,e){let a=m({tag:"div",attr:{id:e.toLowerCase()},classList:["side-item"]});if(a.append(m({tag:"i",classList:["fa",`fa-${t}`],attr:{"aria-hidden":"true"}}),m({tag:"span",text:e})),"Projects"===e){let t=m({tag:"div"});return t.append(a,m({tag:"div",classList:["project-items"]})),t}return a};!function(){const e=document.querySelector("#container");[g(),v(),m({tag:"div",classList:["main-container"]})].forEach((t=>{e.appendChild(t)})),document.querySelector("#home").classList.add("selected"),null===localStorage.getItem("Home")&&localStorage.setItem("Home",JSON.stringify([])),t(),i("Home")}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDYkMsRUFBVVAsWUFBWU0sTUFHeEIxQixTQUFTQyxjQUFjLFNBQVNVLFVBQVVJLElBQUksWUFDVCxPQUFqQ2xCLGFBQWEyQyxRQUFRLFNBQ3ZCM0MsYUFBYTRDLFFBQVEsT0FBUUMsS0FBS0MsVUFBVSxLSGY5Q2xELElBQ0FzQyxFR2lCVyxRQ3BCYndGLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90by1kby1vZGluLy4vc3JjL21vZHVsZXMvcmVmcmVzaERPTS5qcyIsIndlYnBhY2s6Ly90by1kby1vZGluLy4vc3JjL21vZHVsZXMvcHJvamVjdEZvcm0uanMiLCJ3ZWJwYWNrOi8vdG8tZG8tb2Rpbi8uL3NyYy9tb2R1bGVzL2NyZWF0ZUVsZW1lbnQuanMiLCJ3ZWJwYWNrOi8vdG8tZG8tb2Rpbi8uL3NyYy9tb2R1bGVzL2luaXRpYWxpemVQYWdlLmpzIiwid2VicGFjazovL3RvLWRvLW9kaW4vLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlRWxlbWVudCwgY3JlYXRlVGFza3MgfSBmcm9tIFwiLi9jcmVhdGVFbGVtZW50LmpzXCI7XG5pbXBvcnQgeyBwcm9qZWN0Rm9ybSwgdGFza0Zvcm0gfSBmcm9tIFwiLi9wcm9qZWN0Rm9ybS5qc1wiO1xuXG5jb25zdCByZWZyZXNoRE9NID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgcmVmcmVzaFByb2plY3RzKCk7XG4gIGxvYWRQYWdlKG5hbWUpO1xufTtcblxuY29uc3QgcmVmcmVzaFByb2plY3RzID0gZnVuY3Rpb24gKCkge1xuICBjb25zdCBwcm9qZWN0cyA9IE9iamVjdC5rZXlzKGxvY2FsU3RvcmFnZSkucmV2ZXJzZSgpO1xuICBjb25zdCBwcm9qZWN0SXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtaXRlbXNcIik7XG4gIGxldCBzZWxlY3RlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VsZWN0ZWRcIik7XG5cbiAgaWYgKHNlbGVjdGVkID09PSBudWxsIHx8IHNlbGVjdGVkLmlkID09PSBcIkhvbWVcIikge1xuICAgIHNlbGVjdGVkID0gXCJcIjtcbiAgfSBlbHNlIHtcbiAgICBzZWxlY3RlZCA9IHNlbGVjdGVkLnRleHRDb250ZW50O1xuICB9XG5cbiAgcHJvamVjdEl0ZW1zLmlubmVySFRNTCA9IFwiXCI7XG4gIHByb2plY3RzLmZvckVhY2goKHByb2plY3QpID0+IHtcbiAgICBpZiAocHJvamVjdCA9PT0gXCJIb21lXCIpIHJldHVybjtcbiAgICBsZXQgcHJvamVjdEl0ZW0gPSBjcmVhdGVFbGVtZW50KHtcbiAgICAgIHRhZzogXCJkaXZcIixcbiAgICAgIGNsYXNzTGlzdDogW1wicHJvamVjdC1pdGVtXCJdLFxuICAgIH0pO1xuXG4gICAgbGV0IHJlbW92ZUljb24gPSBjcmVhdGVFbGVtZW50KHtcbiAgICAgIHRhZzogXCJpXCIsXG4gICAgICBjbGFzc0xpc3Q6IFtcImZhXCIsIFwiZmEtdGltZXNcIiwgXCJzbVwiLCBcInJlbW92ZS1wLWl0ZW1cIl0sXG4gICAgfSk7XG5cbiAgICBsZXQgcHJvamVjdE5hbWUgPSBjcmVhdGVFbGVtZW50KHtcbiAgICAgIHRhZzogXCJkaXZcIixcbiAgICAgIGNsYXNzTGlzdDogW1wicHJvamVjdC1uYW1lXCJdLFxuICAgICAgdGV4dDogcHJvamVjdCxcbiAgICB9KTtcblxuICAgIGlmIChzZWxlY3RlZCA9PT0gcHJvamVjdCkge1xuICAgICAgcHJvamVjdE5hbWUuY2xhc3NMaXN0LmFkZChcInNlbGVjdGVkXCIpO1xuICAgIH1cblxuICAgIHJlbW92ZUljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShwcm9qZWN0KTtcbiAgICAgIGxldCBzZWxlY3RlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VsZWN0ZWRcIik7XG5cbiAgICAgIHNlbGVjdGVkID0gc2VsZWN0ZWQudGV4dENvbnRlbnQ7XG5cbiAgICAgIGlmIChzZWxlY3RlZCA9PT0gcHJvamVjdCkge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tY29udGFpbmVyXCIpLmlubmVySFRNTCA9IFwiXCI7XG4gICAgICB9XG4gICAgICByZWZyZXNoUHJvamVjdHMoKTtcbiAgICB9KTtcblxuICAgIHByb2plY3RJdGVtLmFwcGVuZChwcm9qZWN0TmFtZSwgcmVtb3ZlSWNvbik7XG5cbiAgICBwcm9qZWN0SXRlbXMuYXBwZW5kQ2hpbGQocHJvamVjdEl0ZW0pO1xuICB9KTtcblxuICBjaGFuZ2VQYWdlKCk7XG59O1xuXG5jb25zdCBjaGFuZ2VQYWdlID0gZnVuY3Rpb24gKCkge1xuICBjb25zdCBwcm9qZWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvamVjdHNcIik7XG4gIGNvbnN0IHByb2plY3RJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvamVjdC1uYW1lXCIpO1xuICBjb25zdCBob21lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNob21lXCIpO1xuXG4gIGhvbWUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGl0ZW1TZWxlY3Rpb24uYmluZChudWxsLCBob21lKSk7XG5cbiAgcHJvamVjdEl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBpdGVtU2VsZWN0aW9uLmJpbmQobnVsbCwgaXRlbSkpO1xuICB9KTtcblxuICBwcm9qZWN0cy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5XCIpKSByZXR1cm47XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHByb2plY3RGb3JtKCkpO1xuICAgIGFkZFByb2plY3QoKTtcbiAgfSk7XG59O1xuXG5jb25zdCBpdGVtU2VsZWN0aW9uID0gZnVuY3Rpb24gKGl0ZW0sIGUpIHtcbiAgbGV0IHNlbGVjdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zZWxlY3RlZFwiKTtcbiAgaWYgKGl0ZW0gPT09IHNlbGVjdGVkKSByZXR1cm47XG4gIGlmIChzZWxlY3RlZCAhPSBudWxsKSB7XG4gICAgc2VsZWN0ZWQuY2xhc3NMaXN0LnJlbW92ZShcInNlbGVjdGVkXCIpO1xuICB9XG4gIGl0ZW0uY2xhc3NMaXN0LmFkZChcInNlbGVjdGVkXCIpO1xuICBpZiAoaXRlbS5pZCA9PT0gXCJob21lXCIpIHtcbiAgICBsb2FkUGFnZShcIkhvbWVcIik7XG4gIH0gZWxzZSB7XG4gICAgbG9hZFBhZ2UoaXRlbS50ZXh0Q29udGVudCk7XG4gIH1cbn07XG5cbmNvbnN0IGFkZFByb2plY3QgPSBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3VibWl0LWJ0blwiKTtcbiAgc3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVGb3JtKTtcbn07XG5cbmZ1bmN0aW9uIGhhbmRsZUZvcm0oZSkge1xuICBsZXQgbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucC1mb3JtLXRleHRcIikudmFsdWU7XG4gIG5hbWUgPSBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTtcbiAgaWYgKG5hbWUgPT09IFwiXCIpIHtcbiAgICBhbGVydChcIlBsZWFzZSBlbnRlciBhIHZhbHVlXCIpO1xuICAgIHJldHVybjtcbiAgfSBlbHNlIGlmIChuYW1lLmxlbmd0aCA+IDEyKSB7XG4gICAgYWxlcnQoXCJWYWx1ZSB0b28gYmlnXCIpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheVwiKS5yZW1vdmUoKTtcbiAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKG5hbWUpID09PSBudWxsKSB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0obmFtZSwgSlNPTi5zdHJpbmdpZnkoW10pKTtcbiAgICByZWZyZXNoUHJvamVjdHMoKTtcbiAgfSBlbHNlIHtcbiAgICBhbGVydChcIlByb2plY3QgYWxyZWFkeSBleGlzdHMuXCIpO1xuICB9XG59XG5cbmNvbnN0IGxvYWRQYWdlID0gZnVuY3Rpb24gKGlkKSB7XG4gIGNvbnN0IG1haW5Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tY29udGFpbmVyXCIpO1xuICBsZXQgcGFnZSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oaWQpKTtcbiAgaWYgKHBhZ2UgPT09IG51bGwpIHtcbiAgICBhbGVydChcIlBhZ2UgZG9lcyBub3QgZXhpc3QuXCIpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIG1haW5Db250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcblxuICBsZXQgaGVhZGVyID0gY3JlYXRlRWxlbWVudCh7XG4gICAgdGFnOiBcImRpdlwiLFxuICAgIGNsYXNzTGlzdDogW1wiaGVhZGVyXCJdLFxuICB9KTtcblxuICBsZXQgaGVhZGluZyA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgIHRhZzogXCJkaXZcIixcbiAgICBjbGFzc0xpc3Q6IFtcIm1haW4taGVhZGluZ1wiXSxcbiAgICB0ZXh0OiBpZCxcbiAgfSk7XG5cbiAgbGV0IGJ1dHRvbiA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgIHRhZzogXCJidXR0b25cIixcbiAgICB0ZXh0OiBcIk5ldyBUYXNrXCIsXG4gICAgY2xhc3NMaXN0OiBbXCJuZXctdGFzay1idG5cIl0sXG4gIH0pO1xuXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY3JlYXRlTmV3VGFzayk7XG4gIGhlYWRlci5hcHBlbmQoaGVhZGluZywgYnV0dG9uKTtcblxuICBtYWluQ29udGFpbmVyLmFwcGVuZENoaWxkKGhlYWRlcik7XG4gIGxvYWRUYXNrcyhwYWdlLCBtYWluQ29udGFpbmVyKTtcbiAgcmVtb3ZlVGFza3MoaWQsIHBhZ2UpO1xufTtcblxuY29uc3QgbG9hZFRhc2tzID0gZnVuY3Rpb24gKGVsZW1lbnRzLCBtYWluQ29udGFpbmVyKSB7XG4gIG1haW5Db250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlVGFza3MoZWxlbWVudHMpKTtcbiAgY29sbGFwc2UoKTtcbn07XG5cbmNvbnN0IHJlbW92ZVRhc2tzID0gZnVuY3Rpb24gKGlkLCBlbGVtZW50cykge1xuICBjb25zdCByZW1vdmVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnJlbW92ZS10YXNrXCIpO1xuICByZW1vdmVCdG4uZm9yRWFjaCgoYnRuKSA9PiB7XG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgZWxlbWVudHMuc3BsaWNlKHBhcnNlSW50KGJ0bi5wYXJlbnRFbGVtZW50LmlkKSwgMSk7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShpZCwgSlNPTi5zdHJpbmdpZnkoZWxlbWVudHMpKTtcbiAgICAgIGxvYWRQYWdlKGlkKTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG5jb25zdCBjb2xsYXBzZSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNvbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwidGFza1wiKTtcbiAgdmFyIGk7XG5cbiAgZm9yIChpID0gMDsgaSA8IGNvbGwubGVuZ3RoOyBpKyspIHtcbiAgICBjb2xsW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNsYXNzTGlzdC50b2dnbGUoXCJhY3RpdmVcIik7XG4gICAgICB2YXIgY29udGVudCA9IHRoaXMubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgaWYgKGNvbnRlbnQuc3R5bGUuZGlzcGxheSA9PT0gXCJibG9ja1wiKSB7XG4gICAgICAgIGNvbnRlbnQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29udGVudC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59O1xuXG5jb25zdCBjcmVhdGVOZXdUYXNrID0gZnVuY3Rpb24gKCkge1xuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGFza0Zvcm0oXCJDcmVhdGVcIikpO1xuICBjb25zdCB0YXNrQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudC1jb250ZW50XCIpO1xuICB0YXNrQ29udGVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheVwiKS5yZW1vdmUoKTtcbiAgICBsZXQga2V5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zZWxlY3RlZFwiKTtcblxuICAgIGlmIChrZXkuaWQgPT09IFwiSG9tZVwiKSB7XG4gICAgICBrZXkgPSBcIkhvbWVcIjtcbiAgICB9IGVsc2Uge1xuICAgICAga2V5ID0ga2V5LnRleHRDb250ZW50O1xuICAgIH1cblxuICAgIGNvbnN0IHByb2plY3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgIGNvbnN0IGZvcm1EYXRhID0gT2JqZWN0LmZyb21FbnRyaWVzKG5ldyBGb3JtRGF0YShlLnRhcmdldCkuZW50cmllcygpKTtcblxuICAgIGlmIChwcm9qZWN0ID09PSBudWxsKSB7XG4gICAgICBhbGVydChcIlByb2plY3QgZG9lcyBub3QgZXhpc3QuXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCB0YXNrcyA9IEpTT04ucGFyc2UocHJvamVjdCk7XG4gICAgdGFza3MucHVzaChmb3JtRGF0YSk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh0YXNrcykpO1xuICAgIGxvYWRQYWdlKGtleSk7XG4gIH0pO1xufTtcblxuZXhwb3J0IHsgcmVmcmVzaERPTSwgbG9hZFBhZ2UgfTtcbiIsImltcG9ydCB7IGNyZWF0ZUVsZW1lbnQgfSBmcm9tIFwiLi9jcmVhdGVFbGVtZW50LmpzXCI7XG5pbXBvcnQgeyBsb2FkUGFnZSB9IGZyb20gXCIuL3JlZnJlc2hET00uanNcIjtcblxuY29uc3QgcHJvamVjdEZvcm0gPSBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGJ1dHRvbnMgPSBjcmVhdGVFbGVtZW50KHtcbiAgICB0YWc6IFwiZGl2XCIsXG4gICAgY2xhc3NMaXN0OiBbXCJwLWZvcm0tYnV0dG9uc1wiXSxcbiAgfSk7XG5cbiAgY29uc3QgY2FuY2VsQnRuID0gY3JlYXRlRWxlbWVudCh7XG4gICAgdGFnOiBcImJ1dHRvblwiLFxuICAgIHRleHQ6IFwiQ2FuY2VsXCIsXG4gICAgY2xhc3NMaXN0OiBbXCJjYW5jZWwtYnRuXCJdLFxuICB9KTtcblxuICBjYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5XCIpLnJlbW92ZSgpO1xuICB9KTtcblxuICBidXR0b25zLmFwcGVuZChcbiAgICBjYW5jZWxCdG4sXG4gICAgY3JlYXRlRWxlbWVudCh7XG4gICAgICB0YWc6IFwiYnV0dG9uXCIsXG4gICAgICB0ZXh0OiBcIk9rYXlcIixcbiAgICAgIGNsYXNzTGlzdDogW1wic3VibWl0LWJ0blwiXSxcbiAgICB9KVxuICApO1xuXG4gIGNvbnN0IHByb2plY3RGb3JtID0gY3JlYXRlRWxlbWVudCh7XG4gICAgdGFnOiBcImRpdlwiLFxuICAgIGNsYXNzTGlzdDogW1wicHJvamVjdC1mb3JtXCJdLFxuICB9KTtcblxuICBwcm9qZWN0Rm9ybS5hcHBlbmQoXG4gICAgY3JlYXRlRWxlbWVudCh7XG4gICAgICB0YWc6IFwiZGl2XCIsXG4gICAgICB0ZXh0OiBcIkNyZWF0ZSBOZXcgUHJvamVjdFwiLFxuICAgICAgY2xhc3NMaXN0OiBbXCJwLWZvcm0taGVhZGluZ1wiXSxcbiAgICB9KSxcblxuICAgIGNyZWF0ZUVsZW1lbnQoe1xuICAgICAgdGFnOiBcImlucHV0XCIsXG4gICAgICBhdHRyOiB7XG4gICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICBwbGFjZWhvbGRlcjogXCJQcm9qZWN0IE5hbWVcIixcbiAgICAgIH0sXG4gICAgICBjbGFzc0xpc3Q6IFtcInAtZm9ybS10ZXh0XCJdLFxuICAgIH0pLFxuICAgIGJ1dHRvbnNcbiAgKTtcblxuICBsZXQgb3ZlcmxheSA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgIHRhZzogXCJkaXZcIixcbiAgICBjbGFzc0xpc3Q6IFtcIm92ZXJsYXlcIl0sXG4gIH0pO1xuXG4gIG92ZXJsYXkuYXBwZW5kKHByb2plY3RGb3JtKTtcblxuICByZXR1cm4gb3ZlcmxheTtcbn07XG5cbmNvbnN0IHRhc2tGb3JtID0gZnVuY3Rpb24gKGtleSkge1xuICBjb25zdCBidXR0b25zID0gY3JlYXRlRWxlbWVudCh7XG4gICAgdGFnOiBcImRpdlwiLFxuICAgIGNsYXNzTGlzdDogW1widC1mb3JtLWJ1dHRvbnNcIl0sXG4gIH0pO1xuXG4gIGNvbnN0IGNhbmNlbEJ0biA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgIHRhZzogXCJidXR0b25cIixcbiAgICB0ZXh0OiBcIkNhbmNlbFwiLFxuICAgIGNsYXNzTGlzdDogW1wiY2FuY2VsLWJ0blwiLCBcImJcIl0sXG4gIH0pO1xuXG4gIGNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlcIikucmVtb3ZlKCk7XG4gIH0pO1xuXG4gIGJ1dHRvbnMuYXBwZW5kKFxuICAgIGNhbmNlbEJ0bixcbiAgICBjcmVhdGVFbGVtZW50KHtcbiAgICAgIHRhZzogXCJidXR0b25cIixcbiAgICAgIHRleHQ6IGtleSxcbiAgICAgIGF0dHI6IHsgZm9yOiBcInRhc2stZm9ybVwiIH0sXG4gICAgICBjbGFzc0xpc3Q6IFtcInQtc3VibWl0LWJ0blwiLCBcImJcIl0sXG4gICAgfSlcbiAgKTtcblxuICBjb25zdCB0YXNrRm9ybSA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgIHRhZzogXCJkaXZcIixcbiAgICBjbGFzc0xpc3Q6IFtcInRhc2stZm9ybVwiXSxcbiAgfSk7XG5cbiAgY29uc3QgdGl0bGUgPSBjcmVhdGVFbGVtZW50KHtcbiAgICB0YWc6IFwibGFiZWxcIixcbiAgICB0ZXh0OiBcIlRpdGxlOlwiLFxuICB9KTtcblxuICB0aXRsZS5hcHBlbmQoXG4gICAgY3JlYXRlRWxlbWVudCh7XG4gICAgICB0YWc6IFwiaW5wdXRcIixcbiAgICAgIGF0dHI6IHtcbiAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgIHJlcXVpcmVkOiBcIlwiLFxuICAgICAgICBuYW1lOiBcInRpdGxlXCIsXG4gICAgICB9LFxuICAgICAgY2xhc3NMaXN0OiBbXCJ0LXRpdGxlXCJdLFxuICAgIH0pXG4gICk7XG5cbiAgY29uc3QgZGVzY3JpcHRpb24gPSBjcmVhdGVFbGVtZW50KHtcbiAgICB0YWc6IFwibGFiZWxcIixcbiAgICB0ZXh0OiBcIkRlc2NyaXB0aW9uOlwiLFxuICB9KTtcblxuICBkZXNjcmlwdGlvbi5hcHBlbmQoXG4gICAgY3JlYXRlRWxlbWVudCh7XG4gICAgICB0YWc6IFwidGV4dGFyZWFcIixcbiAgICAgIGF0dHI6IHtcbiAgICAgICAgcm93czogXCI0XCIsXG4gICAgICAgIG5hbWU6IFwiZGVzY3JpcHRpb25cIixcbiAgICAgIH0sXG4gICAgICBjbGFzc0xpc3Q6IFtcInQtZGVzY3JpcHRpb25cIl0sXG4gICAgfSlcbiAgKTtcblxuICBjb25zdCBwcmlvcml0eSA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgIHRhZzogXCJsYWJlbFwiLFxuICAgIGNsYXNzTGlzdDogW1wibVwiXSxcbiAgfSk7XG5cbiAgcHJpb3JpdHkuaW5uZXJIVE1MID0gYFByaW9yaXR5OlxuICAgPGlucHV0IGlkPVwibG93XCIgdHlwZT1cInJhZGlvXCIgbmFtZT1cInByaW9yaXR5XCIgdmFsdWU9XCJsb3dcIiBjaGVja2VkPlxuICAgPGxhYmVsIGNsYXNzPVwiclwiIGZvcj1cImxvd1wiPkxvdzwvbGFiZWw+XG4gICA8aW5wdXQgaWQ9XCJtZWRpdW1cIiB0eXBlPVwicmFkaW9cIiBuYW1lPVwicHJpb3JpdHlcIiB2YWx1ZT1cIm1lZGl1bVwiPlxuICAgPGxhYmVsIGNsYXNzPVwiclwiIGZvcj1cIm1lZGl1bVwiPk1lZGl1bTwvbGFiZWw+XG4gICA8aW5wdXQgaWQ9XCJoaWdoXCIgdHlwZT1cInJhZGlvXCIgbmFtZT1cInByaW9yaXR5XCIgdmFsdWU9XCJoaWdoXCI+XG4gICA8bGFiZWwgY2xhc3M9XCJyXCIgZm9yPVwiaGlnaFwiPkhpZ2g8L2xhYmVsPmA7XG5cbiAgY29uc3QgZHVlRGF0ZSA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgIHRhZzogXCJsYWJlbFwiLFxuICAgIHRleHQ6IFwiRHVlIERhdGU6XCIsXG4gICAgY2xhc3NMaXN0OiBbXCJtXCJdLFxuICB9KTtcblxuICBkdWVEYXRlLmFwcGVuZChcbiAgICBjcmVhdGVFbGVtZW50KHtcbiAgICAgIHRhZzogXCJpbnB1dFwiLFxuICAgICAgYXR0cjogeyB0eXBlOiBcImRhdGVcIiwgcmVxdWlyZWQ6IFwiXCIsIG5hbWU6IFwiZHVlRGF0ZVwiIH0sXG4gICAgfSlcbiAgKTtcblxuICBjb25zdCBmb3JtQ29udGVudCA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgIHRhZzogXCJmb3JtXCIsXG4gICAgY2xhc3NMaXN0OiBbXCJ0LWNvbnRlbnRcIl0sXG4gICAgYXR0cjogeyBpZDogXCJ0YXNrLWZvcm1cIiwgYWN0aW9uOiBcIiBcIiwgbWV0aG9kOiBcInBvc3RcIiB9LFxuICB9KTtcblxuICBmb3JtQ29udGVudC5hcHBlbmQodGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgZHVlRGF0ZSwgYnV0dG9ucyk7XG5cbiAgdGFza0Zvcm0uYXBwZW5kKFxuICAgIGNyZWF0ZUVsZW1lbnQoe1xuICAgICAgdGFnOiBcImRpdlwiLFxuICAgICAgdGV4dDogYCR7a2V5fSB0YXNrYCxcbiAgICAgIGNsYXNzTGlzdDogW1widC1mb3JtLWhlYWRpbmdcIl0sXG4gICAgfSksXG4gICAgZm9ybUNvbnRlbnRcbiAgKTtcblxuICBsZXQgb3ZlcmxheSA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgIHRhZzogXCJkaXZcIixcbiAgICBjbGFzc0xpc3Q6IFtcIm92ZXJsYXlcIl0sXG4gIH0pO1xuXG4gIG92ZXJsYXkuYXBwZW5kKHRhc2tGb3JtKTtcblxuICByZXR1cm4gb3ZlcmxheTtcbn07XG5cbmNvbnN0IGVkaXRUYXNrRm9ybSA9IGZ1bmN0aW9uICh0YXNrLCBpZCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5XCIpKSByZXR1cm47XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY29udGFpbmVyXCIpO1xuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGFza0Zvcm0oXCJFZGl0XCIpKTtcblxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnQtdGl0bGVcIikudmFsdWUgPSB0YXNrLnRpdGxlO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnQtZGVzY3JpcHRpb25cIikudmFsdWUgPSB0YXNrLmRlc2NyaXB0aW9uO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHt0YXNrLnByaW9yaXR5fWApLmNoZWNrZWQgPSB0cnVlO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiW25hbWUgPSBkdWVEYXRlXVwiKS52YWx1ZSA9IHRhc2suZHVlRGF0ZTtcblxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhc2stZm9ybVwiKS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgbGV0IGtleSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VsZWN0ZWRcIik7XG5cbiAgICBpZiAoa2V5LmlkID09PSBcIkhvbWVcIikge1xuICAgICAga2V5ID0gXCJIb21lXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGtleSA9IGtleS50ZXh0Q29udGVudDtcbiAgICB9XG5cbiAgICBjb25zdCBwcm9qZWN0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTtcbiAgICBjb25zdCBmb3JtRGF0YSA9IE9iamVjdC5mcm9tRW50cmllcyhuZXcgRm9ybURhdGEoZS50YXJnZXQpLmVudHJpZXMoKSk7XG5cbiAgICBpZiAocHJvamVjdCA9PT0gbnVsbCkge1xuICAgICAgYWxlcnQoXCJQcm9qZWN0IGRvZXMgbm90IGV4aXN0LlwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoSlNPTi5zdHJpbmdpZnkoZm9ybURhdGEpID09PSBKU09OLnN0cmluZ2lmeSh0YXNrKSkge1xuICAgICAgYWxlcnQoXCJObyBjaGFuZ2VzIG1hZGVcIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5XCIpLnJlbW92ZSgpO1xuXG4gICAgbGV0IHRhc2tzID0gSlNPTi5wYXJzZShwcm9qZWN0KTtcbiAgICB0YXNrcy5zcGxpY2UoaWQsIDEsIGZvcm1EYXRhKTtcbiAgICBcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHRhc2tzKSk7XG4gICAgbG9hZFBhZ2Uoa2V5KTtcblxuICB9KTtcbn07XG5cbmV4cG9ydCB7IHByb2plY3RGb3JtLCB0YXNrRm9ybSwgZWRpdFRhc2tGb3JtIH07XG4iLCJpbXBvcnQgeyBlZGl0VGFza0Zvcm0gfSBmcm9tIFwiLi9wcm9qZWN0Rm9ybS5qc1wiXG5cbmNvbnN0IGNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAob2JqKSB7XG4gIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChvYmoudGFnKTtcblxuICBpZiAoXCJhdHRyXCIgaW4gb2JqKSB7XG4gICAgbGV0IGF0dHJPYmogPSBvYmouYXR0cjtcbiAgICBmb3IgKGxldCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoYXR0ck9iaikpIHtcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGtleSwgdmFsdWUpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChvYmouY2xhc3NMaXN0ICE9IHVuZGVmaW5lZCkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCguLi5vYmouY2xhc3NMaXN0KTtcbiAgfVxuXG4gIGlmIChcInRleHRcIiBpbiBvYmopIHtcbiAgICBlbGVtZW50LnRleHRDb250ZW50ID0gb2JqLnRleHQ7XG4gIH1cblxuICByZXR1cm4gZWxlbWVudDtcbn07XG5cbmNvbnN0IGNyZWF0ZVRhc2tzID0gZnVuY3Rpb24gKHRhc2tzKSB7XG4gICAgbGV0IHRhc2tzSG9sZGVyID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICB0YWc6IFwiZGl2XCIsXG4gICAgICBjbGFzczogXCJ0YXNrcy1jb250YWluZXJcIixcbiAgICB9KTtcblxuICAgIGxldCBpZCA9IC0xO1xuXG4gICAgdGFza3MuZm9yRWFjaCgodGFzaykgPT4ge1xuICAgICAgbGV0IHAgPSB0YXNrLnByaW9yaXR5O1xuICAgICAgbGV0IGNvbG9yID0gXCJcIjtcblxuICAgICAgaWQgKz0gMTtcbiAgXG4gICAgICBpZiAocCA9PT0gXCJsb3dcIikge1xuICAgICAgICBjb2xvciA9IFwidGFzay1ibHVlXCI7XG4gICAgICB9IGVsc2UgaWYgKHAgPT09IFwibWVkaXVtXCIpIHtcbiAgICAgICAgY29sb3IgPSBcInRhc2steWVsbG93XCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb2xvciA9IFwidGFzay1yZWRcIjtcbiAgICAgIH1cbiAgXG4gICAgICBjb25zdCB2aXNpYmxlID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICAgIHRhZzogXCJkaXZcIixcbiAgICAgICAgY2xhc3NMaXN0OiBbY29sb3IsIFwidGFza1wiXVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHZpc2libGUuYXBwZW5kKGNyZWF0ZUVsZW1lbnQoe1xuICAgICAgICB0YWc6IFwiZGl2XCIsXG4gICAgICAgIGNsYXNzTGlzdDogW1widGFzay10aXRsZVwiXSxcbiAgICAgICAgdGV4dDogdGFzay50aXRsZSxcbiAgICAgIH0pLCBjcmVhdGVFbGVtZW50KHtcbiAgICAgICAgdGFnOiBcImRpdlwiLFxuICAgICAgICBjbGFzc0xpc3Q6IFtcInRhc2stZHVlLWRhdGVcIl0sXG4gICAgICAgIHRleHQ6IHRhc2suZHVlRGF0ZSxcbiAgICAgIH0pLCBjcmVhdGVFbGVtZW50KHtcbiAgICAgICAgdGFnOiBcImlcIixcbiAgICAgICAgY2xhc3NMaXN0OiBbXCJmYVwiLCBcImZhLXRpbWVzXCIsIFwic21cIiwgXCJyZW1vdmUtdGFza1wiXVxuICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgY29uc3QgaGlkZGVuID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICAgIHRhZzogXCJkaXZcIixcbiAgICAgICAgY2xhc3NMaXN0OiBbXCJoaWRkZW5cIl1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgICAgICB0YWc6IFwiZGl2XCIsXG4gICAgICAgIGNsYXNzTGlzdDogW1widGFzay1kZXNjcmlwdGlvblwiXVxuICAgICAgfSk7XG5cbiAgICAgIGRlc2NyaXB0aW9uLmlubmVySFRNTCA9IGA8c3BhbiBjbGFzcz1cImJvbGRcIj5EZXRhaWxzOjwvc3Bhbj4gJHt0YXNrLmRlc2NyaXB0aW9ufWBcblxuICAgICAgY29uc3QgcHJpb3JpdHkgPSBjcmVhdGVFbGVtZW50KHtcbiAgICAgICAgdGFnOiBcImRpdlwiLFxuICAgICAgICBjbGFzc0xpc3Q6IFtcInRhc2stcHJpb3JpdHlcIl1cbiAgICAgIH0pO1xuXG4gICAgICBwcmlvcml0eS5pbm5lckhUTUwgPSBgPHNwYW4gY2xhc3M9XCJib2xkXCI+UHJpb3JpdHk6PC9zcGFuPiAke3Rhc2sucHJpb3JpdHl9YFxuXG4gICAgICBjb25zdCBlZGl0QnRuID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICAgIHRhZzogXCJidXR0b25cIixcbiAgICAgICAgY2xhc3NMaXN0OiBbXCJlZGl0LXRhc2tcIl0sXG4gICAgICAgIHRleHQ6IFwiRWRpdCBEZXRhaWxzXCJcbiAgICAgIH0pO1xuXG4gICAgICBlZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgZWRpdFRhc2tGb3JtKHRhc2ssIGlkKTtcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGhpZGRlbi5hcHBlbmQoZGVzY3JpcHRpb24sIHByaW9yaXR5LCBlZGl0QnRuKTtcblxuICAgICAgdGFza3NIb2xkZXIuYXBwZW5kKHZpc2libGUsIGhpZGRlbik7XG4gICAgfSk7XG4gIFxuICAgIHJldHVybiB0YXNrc0hvbGRlcjtcbiAgfTtcblxuZXhwb3J0IHsgY3JlYXRlRWxlbWVudCwgY3JlYXRlVGFza3MgfTtcbiIsImltcG9ydCB7IGNyZWF0ZUVsZW1lbnQgfSBmcm9tIFwiLi9jcmVhdGVFbGVtZW50LmpzXCI7XG5pbXBvcnQgeyByZWZyZXNoRE9NIH0gZnJvbSBcIi4vcmVmcmVzaERPTS5qc1wiO1xuXG5jb25zdCBpbml0aWFsaXplUGFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjb250YWluZXJcIik7XG4gIGNvbnN0IGl0ZW1zID0gW1xuICAgIGNyZWF0ZU5hdmJhcigpLFxuICAgIGNyZWF0ZVNpZGViYXIoKSxcbiAgICBjcmVhdGVFbGVtZW50KHtcbiAgICAgIHRhZzogXCJkaXZcIixcbiAgICAgIGNsYXNzTGlzdDogW1wibWFpbi1jb250YWluZXJcIl0sXG4gICAgfSksXG4gIF07XG4gIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaXRlbSk7XG4gIH0pO1xuXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaG9tZVwiKS5jbGFzc0xpc3QuYWRkKFwic2VsZWN0ZWRcIik7XG4gIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIkhvbWVcIikgPT09IG51bGwpIHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIkhvbWVcIiwgSlNPTi5zdHJpbmdpZnkoW10pKTtcbiAgfVxuXG4gIHJlZnJlc2hET00oXCJIb21lXCIpO1xufTtcblxuY29uc3QgY3JlYXRlTmF2YmFyID0gZnVuY3Rpb24gKCkge1xuICBsZXQgbmF2QmFyID0gY3JlYXRlRWxlbWVudCh7XG4gICAgdGFnOiBcImRpdlwiLFxuICAgIGNsYXNzTGlzdDogW1wibmF2LWJhclwiXSxcbiAgfSk7XG5cbiAgbmF2QmFyLmFwcGVuZChcbiAgICBjcmVhdGVFbGVtZW50KHtcbiAgICAgIHRhZzogXCJpXCIsXG4gICAgICBjbGFzc0xpc3Q6IFtcImZhXCIsIFwiZmEtdGFza3NcIiwgXCJmYS0zeFwiXSxcbiAgICAgIGF0dHI6IHtcbiAgICAgICAgXCJhcmlhLWhpZGRlblwiOiBcInRydWVcIixcbiAgICAgIH0sXG4gICAgfSksXG4gICAgY3JlYXRlRWxlbWVudCh7XG4gICAgICB0YWc6IFwiZGl2XCIsXG4gICAgICBjbGFzc0xpc3Q6IFtcIm5hdi1oZWFkaW5nXCJdLFxuICAgICAgdGV4dDogXCJUby1Eb1wiLFxuICAgIH0pLFxuICAgIGNyZWF0ZUVsZW1lbnQoe1xuICAgICAgdGFnOiBcImRpdlwiLFxuICAgICAgY2xhc3NMaXN0OiBbXCJuYXYtc2lkZVwiXSxcbiAgICAgIHRleHQ6IFwiVGFza3MgYW5kIE5vdGVzXCIsXG4gICAgfSlcbiAgKTtcblxuICByZXR1cm4gbmF2QmFyO1xufTtcblxuY29uc3QgY3JlYXRlU2lkZWJhciA9IGZ1bmN0aW9uICgpIHtcbiAgbGV0IHNpZGVCYXIgPSBjcmVhdGVFbGVtZW50KHtcbiAgICB0YWc6IFwiZGl2XCIsXG4gICAgY2xhc3NMaXN0OiBbXCJzaWRlLWJhclwiXSxcbiAgfSk7XG5cbiAgc2lkZUJhci5hcHBlbmQoXG4gICAgY3JlYXRlU2lkZUl0ZW0oXCJob21lXCIsIFwiSG9tZVwiKSxcbiAgICBjcmVhdGVTaWRlSXRlbShcImJyaWVmY2FzZVwiLCBcIlByb2plY3RzXCIpXG4gICk7XG5cbiAgcmV0dXJuIHNpZGVCYXI7XG59O1xuXG5jb25zdCBjcmVhdGVTaWRlSXRlbSA9IGZ1bmN0aW9uIChpY29uLCB0ZXh0KSB7XG4gIGxldCBzaWRlSXRlbSA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgIHRhZzogXCJkaXZcIixcbiAgICBhdHRyOiB7XG4gICAgICBpZDogdGV4dC50b0xvd2VyQ2FzZSgpLFxuICAgIH0sXG4gICAgY2xhc3NMaXN0OiBbXCJzaWRlLWl0ZW1cIl0sXG4gIH0pO1xuXG4gIHNpZGVJdGVtLmFwcGVuZChcbiAgICBjcmVhdGVFbGVtZW50KHtcbiAgICAgIHRhZzogXCJpXCIsXG4gICAgICBjbGFzc0xpc3Q6IFtcImZhXCIsIGBmYS0ke2ljb259YF0sXG4gICAgICBhdHRyOiB7XG4gICAgICAgIFwiYXJpYS1oaWRkZW5cIjogXCJ0cnVlXCIsXG4gICAgICB9LFxuICAgIH0pLFxuICAgIGNyZWF0ZUVsZW1lbnQoe1xuICAgICAgdGFnOiBcInNwYW5cIixcbiAgICAgIHRleHQ6IHRleHQsXG4gICAgfSlcbiAgKTtcblxuICBpZiAodGV4dCA9PT0gXCJQcm9qZWN0c1wiKSB7XG4gICAgbGV0IGRpdiA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgICAgdGFnOiBcImRpdlwiLFxuICAgIH0pO1xuXG4gICAgZGl2LmFwcGVuZChcbiAgICAgIHNpZGVJdGVtLFxuICAgICAgY3JlYXRlRWxlbWVudCh7XG4gICAgICAgIHRhZzogXCJkaXZcIixcbiAgICAgICAgY2xhc3NMaXN0OiBbXCJwcm9qZWN0LWl0ZW1zXCJdLFxuICAgICAgfSlcbiAgICApO1xuXG4gICAgcmV0dXJuIGRpdjtcbiAgfVxuXG4gIHJldHVybiBzaWRlSXRlbTtcbn07XG5cbmV4cG9ydCB7IGluaXRpYWxpemVQYWdlIH07XG4iLCJpbXBvcnQgeyBpbml0aWFsaXplUGFnZSB9IGZyb20gXCIuL21vZHVsZXMvaW5pdGlhbGl6ZVBhZ2UuanNcIjtcblxuaW5pdGlhbGl6ZVBhZ2UoKTtcbiJdLCJuYW1lcyI6WyJyZWZyZXNoUHJvamVjdHMiLCJwcm9qZWN0cyIsIk9iamVjdCIsImtleXMiLCJsb2NhbFN0b3JhZ2UiLCJyZXZlcnNlIiwicHJvamVjdEl0ZW1zIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic2VsZWN0ZWQiLCJpZCIsInRleHRDb250ZW50IiwiaW5uZXJIVE1MIiwiZm9yRWFjaCIsInByb2plY3QiLCJwcm9qZWN0SXRlbSIsImNyZWF0ZUVsZW1lbnQiLCJ0YWciLCJjbGFzc0xpc3QiLCJyZW1vdmVJY29uIiwicHJvamVjdE5hbWUiLCJ0ZXh0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJyZW1vdmVJdGVtIiwiYXBwZW5kIiwiYXBwZW5kQ2hpbGQiLCJjaGFuZ2VQYWdlIiwicXVlcnlTZWxlY3RvckFsbCIsImhvbWUiLCJpdGVtU2VsZWN0aW9uIiwiYmluZCIsIml0ZW0iLCJjb250YWluZXIiLCJwcm9qZWN0Rm9ybSIsImFkZFByb2plY3QiLCJyZW1vdmUiLCJsb2FkUGFnZSIsImhhbmRsZUZvcm0iLCJuYW1lIiwidmFsdWUiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwibGVuZ3RoIiwiYWxlcnQiLCJnZXRJdGVtIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtYWluQ29udGFpbmVyIiwicGFnZSIsInBhcnNlIiwiaGVhZGVyIiwiaGVhZGluZyIsImJ1dHRvbiIsImNyZWF0ZU5ld1Rhc2siLCJsb2FkVGFza3MiLCJyZW1vdmVUYXNrcyIsImVsZW1lbnRzIiwiY3JlYXRlVGFza3MiLCJjb2xsYXBzZSIsImJ0biIsInNwbGljZSIsInBhcnNlSW50IiwicGFyZW50RWxlbWVudCIsImkiLCJjb2xsIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInRoaXMiLCJ0b2dnbGUiLCJjb250ZW50IiwibmV4dEVsZW1lbnRTaWJsaW5nIiwic3R5bGUiLCJkaXNwbGF5IiwidGFza0Zvcm0iLCJwcmV2ZW50RGVmYXVsdCIsImtleSIsImZvcm1EYXRhIiwiZnJvbUVudHJpZXMiLCJGb3JtRGF0YSIsInRhcmdldCIsImVudHJpZXMiLCJ0YXNrcyIsInB1c2giLCJidXR0b25zIiwiY2FuY2VsQnRuIiwiYXR0ciIsInR5cGUiLCJwbGFjZWhvbGRlciIsIm92ZXJsYXkiLCJmb3IiLCJ0aXRsZSIsInJlcXVpcmVkIiwiZGVzY3JpcHRpb24iLCJyb3dzIiwicHJpb3JpdHkiLCJkdWVEYXRlIiwiZm9ybUNvbnRlbnQiLCJhY3Rpb24iLCJtZXRob2QiLCJvYmoiLCJlbGVtZW50IiwiYXR0ck9iaiIsInNldEF0dHJpYnV0ZSIsInVuZGVmaW5lZCIsInRhc2tzSG9sZGVyIiwiY2xhc3MiLCJ0YXNrIiwicCIsImNvbG9yIiwidmlzaWJsZSIsImhpZGRlbiIsImVkaXRCdG4iLCJjaGVja2VkIiwiZWRpdFRhc2tGb3JtIiwiY3JlYXRlTmF2YmFyIiwibmF2QmFyIiwiY3JlYXRlU2lkZWJhciIsInNpZGVCYXIiLCJjcmVhdGVTaWRlSXRlbSIsImljb24iLCJzaWRlSXRlbSIsInRvTG93ZXJDYXNlIiwiZGl2IiwiaW5pdGlhbGl6ZVBhZ2UiXSwic291cmNlUm9vdCI6IiJ9